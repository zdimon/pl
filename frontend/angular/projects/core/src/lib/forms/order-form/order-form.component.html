<form [formGroup]="form" (ngSubmit)="onSubmit()" fxLayout="column" fxLayoutGap="10px">

    <mat-form-field appearance="fill">
        <mat-label>Заголовок</mat-label>
        <mat-icon matSuffix>info</mat-icon>
        <mat-error *ngIf="form.controls.title.invalid">Поле обязательно</mat-error>
        <input formControlName="title" matInput placeholder="заголовок">
    </mat-form-field>

    <mat-form-field appearance="fill">
        <mat-label>Описание</mat-label>
        <mat-icon matSuffix>verified</mat-icon>
       <textarea formControlName="desc" matInput></textarea>
    </mat-form-field>

    <mat-form-field appearance="outline">
        <mat-label> Категория </mat-label>
        <mat-select 
        (selectionChange)="changeCategory($event)" 
        formControlName="category">
          <mat-option *ngFor="let cat of (categories | async)" [value]="cat.id">
            {{ cat.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label> Подкатегория </mat-label>
        <mat-select 
        (selectionChange)="changeSubCategory($event)" 
        formControlName="subCategory">
          <mat-option *ngFor="let subcat of (subCategories | async)" [value]="subcat.id">
            {{ subcat.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <!-- controls -->
      <ng-container  *ngFor="let item of controls">
        <mat-form-field appearance="outline" *ngIf="item.type === 'Select'">
          <mat-label>{{item.name}}</mat-label>
          <mat-select formControlName="{{item.alias}}">
            <mat-option *ngFor="let opt of item.option" [value]="opt.value">
              {{ opt.text }}
            </mat-option>
          </mat-select>
        </mat-form-field>

          <mat-form-field appearance="fill" *ngIf="item.type === 'NumericTextbox'">
            <mat-label>{{ item.name }} </mat-label>
            <input formControlName="{{item.alias}}" matInput >
          </mat-form-field>

          <mat-form-field appearance="fill" *ngIf="item.type === 'Container'">
            <mat-label>{{ item.name }} </mat-label>
            <textarea formControlName="{{item.alias}}" matInput ></textarea>
            
          </mat-form-field>

          <div
          *ngIf="item.type === 'Checkbox'"
          formGroupName="{{item.alias}}"
          fxLayout="column" fxLayoutGap="10px"
          >
            <p>{{ item.name }} </p>
 
            <mat-checkbox *ngFor="let opt of item.option; let i=index"
            formControlName="{{i}}">{{ opt.text }}</mat-checkbox>
        </div>
      </ng-container>
      

    <button [disabled]="!form.valid" mat-raised-button  color="accent">Сохранить</button>

</form>

